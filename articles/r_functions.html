<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Functions, useful packages • BasicR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Functions, useful packages">
<meta property="og:description" content="BasicR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BasicR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/R_data_types.html">R Data types</a>
    </li>
    <li>
      <a href="../articles/S4_classes.html">S4 classes</a>
    </li>
    <li>
      <a href="../articles/S4_classes_exercises.html">S4 classes, exercises</a>
    </li>
    <li>
      <a href="../articles/assignment.html">Assignment</a>
    </li>
    <li>
      <a href="../articles/basic_functions.html">Basic functions</a>
    </li>
    <li>
      <a href="../articles/control_structures.html">Control structures</a>
    </li>
    <li>
      <a href="../articles/data_types_exercises.html">Data types, exercises</a>
    </li>
    <li>
      <a href="../articles/data_types_exercises_solutions.html">Data types, solutions</a>
    </li>
    <li>
      <a href="../articles/enrichment.html">Enrichment analysis</a>
    </li>
    <li>
      <a href="../articles/exercises_control_exercises.html">Control structures, exercises</a>
    </li>
    <li>
      <a href="../articles/exercises_control_solutions.html">Control structures, solutions</a>
    </li>
    <li>
      <a href="../articles/functions_exercises.html">Functions, exercises</a>
    </li>
    <li>
      <a href="../articles/functions_exercises_solutions.html">Functions, solutions</a>
    </li>
    <li>
      <a href="../articles/intro.html">Course introduction</a>
    </li>
    <li>
      <a href="../articles/r_functions.html">Functions, useful packages</a>
    </li>
    <li>
      <a href="../articles/references.html">References</a>
    </li>
    <li>
      <a href="../articles/reproducible.html">Reproducible programming</a>
    </li>
    <li>
      <a href="../articles/reproducible_solutions.html">Reproducible programming, exercises</a>
    </li>
    <li>
      <a href="../articles/set_up_git.html">Set up git</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CompEpigen/BasicR">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="r_functions_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Functions, useful packages</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CompEpigen/BasicR/blob/master/vignettes/r_functions.Rmd"><code>vignettes/r_functions.Rmd</code></a></small>
      <div class="hidden name"><code>r_functions.Rmd</code></div>

    </div>

    
    
<div id="useful-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#useful-packages" class="anchor"></a>Useful packages:</h1>
<div id="interactive-visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#interactive-visualization" class="anchor"></a>Interactive visualization:</h2>
<p><code>plotly</code> <code>ggplotly</code> <code>Glimma</code></p>
</div>
<div id="nice-tables-in-rmarkdown" class="section level2">
<h2 class="hasAnchor">
<a href="#nice-tables-in-rmarkdown" class="anchor"></a>nice tables in Rmarkdown</h2>
<p><code>datatable</code></p>
</div>
<div id="enrichment-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#enrichment-analysis" class="anchor"></a>enrichment analysis</h2>
<p><code>clusterProfiler</code></p>
</div>
<div id="annotation-of-genomic-regions" class="section level2">
<h2 class="hasAnchor">
<a href="#annotation-of-genomic-regions" class="anchor"></a>annotation of genomic regions</h2>
<p><code>annotatr</code></p>
</div>
<div id="gene-exoression-sequencing" class="section level2">
<h2 class="hasAnchor">
<a href="#gene-exoression-sequencing" class="anchor"></a>Gene exoression, sequencing</h2>
<p><code>DESeq2</code> <code>EdgeR</code></p>
</div>
<div id="mutation-data" class="section level2">
<h2 class="hasAnchor">
<a href="#mutation-data" class="anchor"></a>mutation data</h2>
<p><code>MAFtools</code></p>
</div>
<div id="visualizatio-genomic-regions" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizatio-genomic-regions" class="anchor"></a>Visualizatio genomic regions</h2>
<p><code>Gviz</code></p>
</div>
<div id="handling-genomic-data-e-g--bam-files" class="section level2">
<h2 class="hasAnchor">
<a href="#handling-genomic-data-e-g--bam-files" class="anchor"></a>Handling genomic data (e.g. bam files)</h2>
<p><code>rtracklayer</code></p>
</div>
<div id="methylation-data" class="section level2">
<h2 class="hasAnchor">
<a href="#methylation-data" class="anchor"></a>Methylation data</h2>
<div id="array" class="section level3">
<h3 class="hasAnchor">
<a href="#array" class="anchor"></a>Array</h3>
<p><code>minfi</code> <code>RnBeads</code></p>
</div>
<div id="sequencing" class="section level3">
<h3 class="hasAnchor">
<a href="#sequencing" class="anchor"></a>Sequencing</h3>
<p><code>methrix</code> <code>bsseq</code></p>
</div>
</div>
<div id="visualization-heatmaps" class="section level2">
<h2 class="hasAnchor">
<a href="#visualization-heatmaps" class="anchor"></a>Visualization, heatmaps</h2>
<p><code>pheatmap</code> <code>Complexheatmap</code></p>
</div>
<div id="nice-colors-palettes" class="section level2">
<h2 class="hasAnchor">
<a href="#nice-colors-palettes" class="anchor"></a>Nice colors palettes</h2>
<p><code>ggsci</code> <code>scico</code></p>
</div>
</div>
<div id="funtions-in-r" class="section level1">
<h1 class="hasAnchor">
<a href="#funtions-in-r" class="anchor"></a>Funtions in R</h1>
<p>R is a function-oriented language. Basically every object manipulation is done with functions. It is possible that during a data analysis we are only using functions from the different packages, but it is useful to write our own functions as well. The main purpose is to avoid code repetition. As a rule of a thumb, if you need to do the same thing more than twice -&gt; write a function instead.</p>
<div id="general-syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#general-syntax" class="anchor"></a>General syntax</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Hello world! \n"</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">f</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Hello world!</code></pre>
<ul>
<li>name: if we want to actually run the function</li>
<li>arguments (optional)</li>
<li>expressions - what the function is doing</li>
<li>return value (options)</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">num1</span>, <span class="va">num2</span><span class="op">)</span><span class="op">{</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">num1</span><span class="op">+</span><span class="va">num2</span>
  <span class="va">res</span>
<span class="op">}</span>
<span class="fu">f</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div id="return-value" class="section level3">
<h3 class="hasAnchor">
<a href="#return-value" class="anchor"></a>Return value</h3>
<ul>
<li><p>Returns the last evaluated function</p></li>
<li><p>Explicitly stated. In this case, the evaluation of the function stops and exits.</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">num1</span>, <span class="va">num2</span><span class="op">)</span><span class="op">{</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">num1</span><span class="op">+</span><span class="va">num2</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Hello world! \n"</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">f</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
</div>
</div>
<div id="arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#arguments" class="anchor"></a>Arguments</h2>
<ul>
<li>Named arguments</li>
<li>Evaluation can be position or name-wise, or even with their combination.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">num1</span>, <span class="va">num2</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">num1</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">num2</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">f</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">f</span><span class="op">(</span>num2<span class="op">=</span><span class="fl">2</span>, num1<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">f</span><span class="op">(</span><span class="fl">2</span>, num1<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 2
## Error in print(num2) : argument "num2" is missing, with no default</code></pre>
<div id="arguments-1" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-1" class="anchor"></a>Arguments</h3>
<ul>
<li>the arguments can have default values:</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">num1</span>, <span class="va">num2</span><span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">num1</span><span class="op">)</span>
  <span class="co">#browser()</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">num2</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">f</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">f</span><span class="op">(</span>num2<span class="op">=</span><span class="fl">2</span>, num1<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">f</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 2
## [1] 3</code></pre>
</div>
<div id="environment" class="section level3">
<h3 class="hasAnchor">
<a href="#environment" class="anchor"></a>Environment</h3>
<p>The functions are working in their own environment. This environment can’t be seen from the outside. E.g. if you define a variable within the function, it won’t be available outside the function. There are certain rules of what variables can be seen from inside the function’s environment. <em>Lexical scoping</em> - searches the environment where the function was defined.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> 
         <span class="va">x</span><span class="op">*</span><span class="va">y</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu">g</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in g(2) : object 'y' not found</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="fu">g</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#but!</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>
<span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in mean.default() : argument "x" is missing, with no default</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> 
  <span class="va">ab</span> <span class="op">&lt;-</span> <span class="fl">12</span>
         <span class="va">x</span><span class="op">*</span><span class="va">y</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ab</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in print(ab) : object 'ab' not found</code></pre>
<p>Why?</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/environment.html">environment</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "f" "g" "x" "y"</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#ls(environment(mean))</span>

<span class="fu"><a href="https://rdrr.io/r/base/search.html">search</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] ".GlobalEnv"        "package:stats"     "package:graphics" 
##  [4] "package:grDevices" "package:utils"     "package:datasets" 
##  [7] "package:methods"   "Autoloads"         "tools:callr"      
## [10] "package:base"</code></pre>
</div>
</div>
<div id="troubleshooting" class="section level2">
<h2 class="hasAnchor">
<a href="#troubleshooting" class="anchor"></a>Troubleshooting</h2>
<p>Due to the own environment, it can be difficult what goes wrong within the function. Useful functions:</p>
<p><code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code> <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> <code><a href="https://rdrr.io/r/base/debug.html">debug()</a></code> <code><a href="https://rdrr.io/r/base/options.html">options(error=recover)</a></code> <code><a href="https://rdrr.io/r/base/options.html">options(error=stop)</a></code></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Reka Toth, Rajbir Nath Batra.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
